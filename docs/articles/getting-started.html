<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • zoltr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zoltr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/project-owners.html">Project Owners</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/reichlab/zoltr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Getting Started</h1>
                        <h4 class="author">Matthew Cornell</h4>
            
            <h4 class="date">2019-05-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/reichlab/zoltr/blob/master/vignettes/getting-started.Rmd"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<div id="getting-started-with-zoltr" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started-with-zoltr" class="anchor"></a>Getting Started with zoltr</h1>
<p>zoltr is an R package that simplifies access to the <a href="https://www.zoltardata.com/">zoltardata.com</a> API. This vignette takes you through the package’s main features. So that you can experiment without needing a Zoltar account, we use our “flagship” project for the CDC Flu challenge, which should always be available for public read-only access.</p>
<div id="connect-to-the-host" class="section level2">
<h2 class="hasAnchor">
<a href="#connect-to-the-host" class="anchor"></a>Connect to the host</h2>
<p>The starting point for working with Zoltar’s API is a <code>ZoltarConnection</code> object, obtained via the <code>new_connection</code> function. Most zoltr functions take a <code>ZoltarConnection</code> along with the <em>ID</em> of the thing of interest, e.g., a project, model, or forecast ID. You can obtain the ID using one of the <code>*_info</code> functions, and you can always use the web interface to navigate to the resource and look at its ID in the browser address field. The ID should be self evident for all resources. For example, the project <a href="https://www.zoltardata.com/project/4">CDC Flu challenge</a>’s URL is <a href="https://www.zoltardata.com/project/4" class="uri">https://www.zoltardata.com/project/4</a>, and you can see that its ID is <em>4</em>.</p>
<p>(Note: To access protected resources, you need to call the <code><a href="../reference/z_authenticate.html">z_authenticate()</a></code> function before calling any zoltr functions. But this is unnecessary in this vignette because we’re accessing a public project, models, and forecasts.)</p>
<!-- run but don't show -->
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(zoltr)
conn &lt;-<span class="st"> </span><span class="kw"><a href="../reference/new_connection.html">new_connection</a></span>()
conn
<span class="co">#&gt; ZoltarConnection 'http://zoltardata.com' (no session)</span></code></pre></div>
</div>
<div id="get-a-list-of-all-projects-on-the-host" class="section level2">
<h2 class="hasAnchor">
<a href="#get-a-list-of-all-projects-on-the-host" class="anchor"></a>Get a list of all projects on the host</h2>
<p>Use the <code><a href="../reference/projects.html">projects()</a></code> function to get a connection’s projects as a data.frame. Note that it will only list those that you are authenticated to access.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">the_projects &lt;-<span class="st"> </span><span class="kw"><a href="../reference/projects.html">projects</a></span>(conn)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(the_projects)
<span class="co">#&gt; 'data.frame':    1 obs. of  8 variables:</span>
<span class="co">#&gt;  $ id         : int 4</span>
<span class="co">#&gt;  $ url        : chr "http://zoltardata.com/api/project/4/"</span>
<span class="co">#&gt;  $ owner_id   : int 5</span>
<span class="co">#&gt;  $ public     : logi TRUE</span>
<span class="co">#&gt;  $ name       : chr "CDC Flu challenge"</span>
<span class="co">#&gt;  $ description: chr "Guidelines and forecasts for a collaborative U.S. influenza forecasting project."</span>
<span class="co">#&gt;  $ home_url   : chr "https://github.com/FluSightNetwork/cdc-flusight-ensemble"</span>
<span class="co">#&gt;  $ core_data  : chr "https://github.com/FluSightNetwork/cdc-flusight-ensemble/tree/master/model-forecasts/component-models"</span></code></pre></div>
</div>
<div id="get-a-project-to-work-with-and-then-list-its-info-and-models" class="section level2">
<h2 class="hasAnchor">
<a href="#get-a-project-to-work-with-and-then-list-its-info-and-models" class="anchor"></a>Get a project to work with and then list its info and models</h2>
<p>Let’s start by getting a public project to work with. We will search the projects list for it by name. Then we will pass its ID to the <code><a href="../reference/project_info.html">project_info()</a></code> function to get details, and pass it to the <code><a href="../reference/models.html">models()</a></code> function to get a data.frame of its models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">project_id &lt;-<span class="st"> </span>the_projects[the_projects<span class="op">$</span>name <span class="op">==</span><span class="st"> "CDC Flu challenge"</span>, <span class="st">'id'</span>]  <span class="co"># integer(0) if not found, which is an invalid project ID</span>
the_project_info &lt;-<span class="st"> </span><span class="kw"><a href="../reference/project_info.html">project_info</a></span>(conn, project_id)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(the_project_info)
<span class="co">#&gt;  [1] "id"           "url"          "owner"        "is_public"   </span>
<span class="co">#&gt;  [5] "name"         "description"  "home_url"     "core_data"   </span>
<span class="co">#&gt;  [9] "config_dict"  "template"     "truth"        "model_owners"</span>
<span class="co">#&gt; [13] "score_data"   "models"       "locations"    "targets"     </span>
<span class="co">#&gt; [17] "timezeros"</span>
the_project_info<span class="op">$</span>description
<span class="co">#&gt; [1] "Guidelines and forecasts for a collaborative U.S. influenza forecasting project."</span>

the_models &lt;-<span class="st"> </span><span class="kw"><a href="../reference/models.html">models</a></span>(conn, project_id)  <span class="co"># may take some time</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(the_models)
<span class="co">#&gt; 'data.frame':    21 obs. of  8 variables:</span>
<span class="co">#&gt;  $ id          : int  12 26 25 24 23 11 10 18 20 21 ...</span>
<span class="co">#&gt;  $ url         : chr  "http://zoltardata.com/api/model/12/" "http://zoltardata.com/api/model/26/" "http://zoltardata.com/api/model/25/" "http://zoltardata.com/api/model/24/" ...</span>
<span class="co">#&gt;  $ project_id  : int  4 4 4 4 4 4 4 4 4 4 ...</span>
<span class="co">#&gt;  $ owner_id    : int  5 5 5 5 5 5 5 5 5 5 ...</span>
<span class="co">#&gt;  $ name        : chr  "Rank Histogram Filter SIRS" "SARIMA model with seasonal differencing" "SARIMA model without seasonal differencing" "Kernel Density Estimation" ...</span>
<span class="co">#&gt;  $ description : chr  "&lt;em&gt;Team name&lt;/em&gt;: CU.\n        &lt;em&gt;Team members&lt;/em&gt;: J Shaman, T Yamana, S Kandula, S Pei, W Yang, H Morita."| __truncated__ "&lt;em&gt;Team name&lt;/em&gt;: ReichLab.\n        &lt;em&gt;Team members&lt;/em&gt;: Evan L. Ray, Nicholas G. Reich.\n        &lt;em&gt;Data"| __truncated__ "&lt;em&gt;Team name&lt;/em&gt;: ReichLab.\n        &lt;em&gt;Team members&lt;/em&gt;: Evan L. Ray, Nicholas G. Reich.\n        &lt;em&gt;Data"| __truncated__ "&lt;em&gt;Team name&lt;/em&gt;: ReichLab.\n        &lt;em&gt;Team members&lt;/em&gt;: Evan L. Ray, Nicholas G. Reich.\n        &lt;em&gt;Data"| __truncated__ ...</span>
<span class="co">#&gt;  $ home_url    : chr  "https://github.com/FluSightNetwork/cdc-flusight-ensemble/tree/master/model-forecasts/component-models/CU_RHF_SIRS" "https://github.com/FluSightNetwork/cdc-flusight-ensemble/tree/master/model-forecasts/component-models/ReichLab_"| __truncated__ "https://github.com/FluSightNetwork/cdc-flusight-ensemble/tree/master/model-forecasts/component-models/ReichLab_"| __truncated__ "https://github.com/FluSightNetwork/cdc-flusight-ensemble/tree/master/model-forecasts/component-models/ReichLab_kde" ...</span>
<span class="co">#&gt;  $ aux_data_url: logi  NA NA NA NA NA NA ...</span></code></pre></div>
</div>
<div id="get-a-model-to-work-with-and-then-list-its-info-and-forecasts-if-any" class="section level2">
<h2 class="hasAnchor">
<a href="#get-a-model-to-work-with-and-then-list-its-info-and-forecasts-if-any" class="anchor"></a>Get a model to work with and then list its info and forecasts (if any)</h2>
<p>Now let’s work with a particular model, getting its ID by name and then passing it to the <code><a href="../reference/model_info.html">model_info()</a></code> function to get details. Then use the <code><a href="../reference/forecasts.html">forecasts()</a></code> function to get a data.frame of that model’s forecasts.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">model_id &lt;-<span class="st"> </span>the_models[the_models<span class="op">$</span>name <span class="op">==</span><span class="st"> "SARIMA model with seasonal differencing"</span>, <span class="st">'id'</span>]  <span class="co"># integer(0) if not found</span>
the_model_info &lt;-<span class="st"> </span><span class="kw"><a href="../reference/model_info.html">model_info</a></span>(conn, model_id)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(the_model_info)
<span class="co">#&gt;  [1] "id"           "url"          "project"      "owner"       </span>
<span class="co">#&gt;  [5] "name"         "abbreviation" "description"  "home_url"    </span>
<span class="co">#&gt;  [9] "aux_data_url" "forecasts"</span>
the_model_info<span class="op">$</span>description
<span class="co">#&gt; [1] "&lt;em&gt;Team name&lt;/em&gt;: ReichLab.\n        &lt;em&gt;Team members&lt;/em&gt;: Evan L. Ray, Nicholas G. Reich.\n        &lt;em&gt;Data source(s)&lt;/em&gt;: ilinet.\n        &lt;em&gt;Methods&lt;/em&gt;: A seasonal ARIMA model is fit using the auto.arima function in the forecast package for R.  The data are log-transformed, any infinite or missing values after the transformation are linearly imputed, and a first-order seasonal difference (at lag 52 weeks) is taken before fitting the model.  A separate model is fit for each region.  Through iterating the one-step-ahead predictions, this model fit yields a joint predictive distribution for incidence in all remaining weeks of the season.  Appropriate integrals of this joint distribution are calculated via Monte Carlo integration to obtain predictions for the seasonal quantities.  For making prospective predictions for each season, only data before the start of that season were used in fitting model parameters.  All code used in estimation and prediction is available at https://github.com/reichlab/2017-2018-cdc-flu-contest\n        "</span>

the_forecasts &lt;-<span class="st"> </span><span class="kw"><a href="../reference/forecasts.html">forecasts</a></span>(conn, model_id)
<span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/str">str</a></span>(the_forecasts)
<span class="co">#&gt; 'data.frame':    225 obs. of  4 variables:</span>
<span class="co">#&gt;  $ id               : int  4539 4540 4541 4542 4543 4544 4545 4546 4547 4548 ...</span>
<span class="co">#&gt;  $ url              : chr  "http://zoltardata.com/api/forecast/4539/" "http://zoltardata.com/api/forecast/4540/" "http://zoltardata.com/api/forecast/4541/" "http://zoltardata.com/api/forecast/4542/" ...</span>
<span class="co">#&gt;  $ timezero_date    : Date, format: "2010-10-24" "2010-10-31" ...</span>
<span class="co">#&gt;  $ data_version_date: Date, format: "2010-11-08" "2010-11-15" ...</span></code></pre></div>
</div>
<div id="finally-download-the-first-forecasts-data-in-two-different-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#finally-download-the-first-forecasts-data-in-two-different-formats" class="anchor"></a>Finally, download the first forecast’s data in two different formats</h2>
<p>You can get forecast data using the <code><a href="../reference/forecast_data.html">forecast_data()</a></code> function, which supports a nested <code>list</code> or a <code>data.table</code> (tabular) format.</p>
<p>First as a <code>list</code>. (Please see <a href="http://127.0.0.1:8000/docs#forecast-data-format">here</a> for nested format, AKA JSON, details.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">first_forecast_id &lt;-<span class="st"> </span>the_forecasts[<span class="dv">1</span>, <span class="st">'id'</span>]  <span class="co"># assumes at least one exists</span>

forecast_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/forecast_data.html">forecast_data</a></span>(conn, first_forecast_id, <span class="dt">is_json=</span><span class="ot">TRUE</span>)
forecast_data<span class="op">$</span>locations[[<span class="dv">1</span>]]<span class="op">$</span>name
<span class="co">#&gt; [1] "HHS Region 1"</span>
forecast_data<span class="op">$</span>locations[[<span class="dv">1</span>]]<span class="op">$</span>targets[[<span class="dv">1</span>]]<span class="op">$</span>name
<span class="co">#&gt; [1] "Season onset"</span>
forecast_data<span class="op">$</span>locations[[<span class="dv">1</span>]]<span class="op">$</span>targets[[<span class="dv">1</span>]]<span class="op">$</span>bins[[<span class="dv">1</span>]]
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt; [1] 44</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1] 45</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1] 0.186</span></code></pre></div>
<p>And as a <code>data.frame</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">forecast_data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/message">suppressMessages</a></span>(<span class="kw"><a href="../reference/forecast_data.html">forecast_data</a></span>(conn, first_forecast_id, <span class="dt">is_json=</span><span class="ot">FALSE</span>))
forecast_data
<span class="co">#&gt; # A tibble: 4,468 x 7</span>
<span class="co">#&gt;    location   target     type  unit  bin_start_incl bin_end_notincl   value</span>
<span class="co">#&gt;    &lt;chr&gt;      &lt;chr&gt;      &lt;chr&gt; &lt;chr&gt;          &lt;dbl&gt;           &lt;dbl&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt;  1 US Nation… Season on… point week              NA              NA 5.00e+0</span>
<span class="co">#&gt;  2 US Nation… Season on… bin   week              45              46 3.00e-4</span>
<span class="co">#&gt;  3 US Nation… Season on… bin   week              46              47 8.00e-4</span>
<span class="co">#&gt;  4 US Nation… Season on… bin   week              47              48 7.00e-4</span>
<span class="co">#&gt;  5 US Nation… Season on… bin   week              48              49 1.00e-3</span>
<span class="co">#&gt;  6 US Nation… Season on… bin   week              49              50 3.00e-3</span>
<span class="co">#&gt;  7 US Nation… Season on… bin   week              50              51 9.60e-3</span>
<span class="co">#&gt;  8 US Nation… Season on… bin   week              51              52 1.15e-2</span>
<span class="co">#&gt;  9 US Nation… Season on… bin   week              52              53 5.10e-3</span>
<span class="co">#&gt; 10 US Nation… Season on… bin   week               1               2 5.00e-4</span>
<span class="co">#&gt; # … with 4,458 more rows</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#getting-started-with-zoltr">Getting Started with zoltr</a><ul class="nav nav-pills nav-stacked">
<li><a href="#connect-to-the-host">Connect to the host</a></li>
      <li><a href="#get-a-list-of-all-projects-on-the-host">Get a list of all projects on the host</a></li>
      <li><a href="#get-a-project-to-work-with-and-then-list-its-info-and-models">Get a project to work with and then list its info and models</a></li>
      <li><a href="#get-a-model-to-work-with-and-then-list-its-info-and-forecasts-if-any">Get a model to work with and then list its info and forecasts (if any)</a></li>
      <li><a href="#finally-download-the-first-forecasts-data-in-two-different-formats">Finally, download the first forecast’s data in two different formats</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Matthew Cornell.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
