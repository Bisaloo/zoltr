<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Getting Started • zoltr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Getting Started">
<meta property="og:description" content="zoltr">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">zoltr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/getting-started.html">Getting Started</a>
    </li>
    <li>
      <a href="../articles/project-owners.html">Project Owners</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/reichlab/zoltr/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Getting Started</h1>
                        <h4 class="author">Matthew Cornell</h4>
            
            <h4 class="date">2020-05-26</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/reichlab/zoltr/blob/master/vignettes/getting-started.Rmd"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="hidden name"><code>getting-started.Rmd</code></div>

    </div>

    
    
<div id="getting-started-with-zoltr" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started-with-zoltr" class="anchor"></a>Getting Started with zoltr</h1>
<p>zoltr is an R package that simplifies access to the <a href="https://www.zoltardata.com/">zoltardata.com</a> API. This vignette takes you through the package’s main features. So that you can experiment without needing a Zoltar account, we use the example project from <a href="https://docs.zoltardata.com/">docs.zoltardata.com</a>, which should always be available for public read-only access.</p>
</div>
<div id="setting-up-your-account" class="section level1">
<h1 class="hasAnchor">
<a href="#setting-up-your-account" class="anchor"></a>Setting up your account</h1>
<p>You need to have an account on Zoltar and be authenticated to the server in order to access data from the API. Once you have an account, we recommend storing your Zoltar username and password in your .Renviron file. In practice this means having a file named <code>.Renviron</code> in your home directory. (You can read more about R and environment variables <a href="https://db.rstudio.com/best-practices/managing-credentials/#use-environment-variables">here</a>.) The lines of code in this vignette will work if you have the following two lines somewhere in your <code>.Renviron</code> file (where you replace your username and password in the appropriate locations). Note there is no space around the <code>=</code> sign:</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="va">Z_USERNAME=</span>insert-your-username-here
<span class="va">Z_PASSWORD=</span>insert-your-password-here</code></pre></div>
<p>Note that the Zoltar service uses a “token”-based scheme for authentication. These tokens have a five minute expiration for security, which requires re-authentication after that period of time. The zoltr library takes care of re-authenticating as needed by passing your username and password back to the server to get another token. Note that the connection object returned by the <code>new_connection</code> function stores a token internally, so be careful if saving that object into a file.</p>
<div id="connect-to-the-host-and-authenticate" class="section level2">
<h2 class="hasAnchor">
<a href="#connect-to-the-host-and-authenticate" class="anchor"></a>Connect to the host and authenticate</h2>
<p>The starting point for working with Zoltar’s API is a <code>ZoltarConnection</code> object, obtained via the <code>new_connection</code> function. Most zoltr functions take a <code>ZoltarConnection</code> along with the API <em>URL</em> of the thing of interest, e.g., a project, model, or forecast. API URLs look like <code>https://www.zoltardata.com/api/project/3/</code>, which is that of the “Docs Example Project”. An important note regarding URLs:</p>
<pre><code>zoltr's convention for URLs is to require a trailing slash character ('/') on all URLs. The only exception is the optional `host` parameter passed to `new_connection()`. Thus, `https://www.zoltardata.com/api/project/3/` is valid, but `https://www.zoltardata.com/api/project/3` is not.</code></pre>
<p>You can obtain a URL using some of the <code>*_info</code> functions, and you can always use the web interface to navigate to the item of interest and look at its URL in the browser address field. Keep in mind that you’ll need to add <code>api</code> to the browsable address, along with the trailing slash character. For example, if you browsed the <em>Docs Example Project</em> project at (say) <code>https://www.zoltardata.com/project/3</code> then its API for use in zoltr would be <code>https://www.zoltardata.com/api/project/3/</code>.</p>
<!-- run but don't show. NB: will run only if above eval=TRUE -->
<!-- run but don't show. NB: will run only if above eval=TRUE -->
<!-- show but don't run-->
<div class="sourceCode"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">zoltr</span>)
<span class="no">zoltar_connection</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/new_connection.html">new_connection</a></span>()
<span class="fu"><a href="../reference/zoltar_authenticate.html">zoltar_authenticate</a></span>(<span class="no">zoltar_connection</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">"Z_USERNAME"</span>), <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html">Sys.getenv</a></span>(<span class="st">"Z_PASSWORD"</span>))
<span class="no">zoltar_connection</span></pre></body></html></div>
</div>
<div id="get-a-list-of-all-projects-on-the-host" class="section level2">
<h2 class="hasAnchor">
<a href="#get-a-list-of-all-projects-on-the-host" class="anchor"></a>Get a list of all projects on the host</h2>
<p>Now that you have a connection, you can use the <code><a href="../reference/projects.html">projects()</a></code> function to get all projects as a <code>data.frame</code>. Note that it will only list those that you are authorized to access, i.e., all public projects plus any private ones that you own or are a model owner.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">the_projects</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/projects.html">projects</a></span>(<span class="no">zoltar_connection</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">the_projects</span>)
<span class="co">#&gt; 'data.frame':    4 obs. of  10 variables:</span>
<span class="co">#&gt;  $ id                   : int  1 2 3 4</span>
<span class="co">#&gt;  $ url                  : chr  "http://127.0.0.1:8000/api/project/1/" "http://127.0.0.1:8000/api/project/2/" "http://127.0.0.1:8000/api/project/3/" "http://127.0.0.1:8000/api/project/4/"</span>
<span class="co">#&gt;  $ owner_url            : chr  "http://127.0.0.1:8000/api/user/1/" "http://127.0.0.1:8000/api/user/2/" "http://127.0.0.1:8000/api/user/2/" "http://127.0.0.1:8000/api/user/2/"</span>
<span class="co">#&gt;  $ public               : logi  TRUE TRUE FALSE TRUE</span>
<span class="co">#&gt;  $ name                 : chr  "COVID-19 Forecasts" "public project" "private project" "Docs Example Project"</span>
<span class="co">#&gt;  $ description          : chr  "The goal of this repository is to create a standardized set of data on forecasts from experienced teams making "| __truncated__ "description" "description" "A full description of my project is here. You could include narrative details about what seasons are included, "| __truncated__</span>
<span class="co">#&gt;  $ home_url             : chr  "https://github.com/reichlab/covid19-forecast-hub/tree/master/data-processed" "http://example.com/" "http://example.com/" "https://reichlab.io"</span>
<span class="co">#&gt;  $ time_interval_type   : chr  "Week" "Week" "Week" "Week"</span>
<span class="co">#&gt;  $ visualization_y_label: chr  "Weighted ILI (%)" "" "" "the scale for your variable of interest"</span>
<span class="co">#&gt;  $ core_data            : chr  "https://github.com/reichlab/covid19-death-forecasts/tree/master/data-processed" "http://example.com/" "http://example.com/" ""</span></pre></body></html></div>
</div>
<div id="get-a-project-to-work-with-and-list-its-info-models-and-scores" class="section level2">
<h2 class="hasAnchor">
<a href="#get-a-project-to-work-with-and-list-its-info-models-and-scores" class="anchor"></a>Get a project to work with and list its info, models, and scores</h2>
<p>Let’s start by getting a public project to work with. We will search the projects list for it by name. Then we will pass its URL to the <code><a href="../reference/project_info.html">project_info()</a></code> function to get a <code>list</code> of details, and then pass it to the <code><a href="../reference/models.html">models()</a></code> function to get a <code>data.frame</code> of its models.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">project_url</span> <span class="kw">&lt;-</span> <span class="no">the_projects</span>[<span class="no">the_projects</span>$<span class="no">name</span> <span class="kw">==</span> <span class="st">"Docs Example Project"</span>, <span class="st">"url"</span>]
<span class="no">the_project_info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/project_info.html">project_info</a></span>(<span class="no">zoltar_connection</span>, <span class="no">project_url</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">the_project_info</span>)
<span class="co">#&gt;  [1] "id"                    "url"                   "owner"                </span>
<span class="co">#&gt;  [4] "is_public"             "name"                  "description"          </span>
<span class="co">#&gt;  [7] "home_url"              "logo_url"              "core_data"            </span>
<span class="co">#&gt; [10] "time_interval_type"    "visualization_y_label" "truth"                </span>
<span class="co">#&gt; [13] "model_owners"          "score_data"            "models"               </span>
<span class="co">#&gt; [16] "units"                 "targets"               "timezeros"</span>
<span class="no">the_project_info</span>$<span class="no">description</span>
<span class="co">#&gt; [1] "A full description of my project is here. You could include narrative details about what seasons are included, what group has provided data, whether the project focuses on real-time or retrospective forecasts."</span>

<span class="no">the_models</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/models.html">models</a></span>(<span class="no">zoltar_connection</span>, <span class="no">project_url</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">the_models</span>)
<span class="co">#&gt; 'data.frame':    1 obs. of  9 variables:</span>
<span class="co">#&gt;  $ id          : int 44</span>
<span class="co">#&gt;  $ url         : chr "http://127.0.0.1:8000/api/model/44/"</span>
<span class="co">#&gt;  $ project_url : chr "http://127.0.0.1:8000/api/project/4/"</span>
<span class="co">#&gt;  $ owner_url   : logi NA</span>
<span class="co">#&gt;  $ name        : chr "docs forecast model"</span>
<span class="co">#&gt;  $ model_abbr  : chr ""</span>
<span class="co">#&gt;  $ description : chr ""</span>
<span class="co">#&gt;  $ home_url    : chr ""</span>
<span class="co">#&gt;  $ aux_data_url: logi NA</span></pre></body></html></div>
<p>There is other project-related information that you can access, such as its configuration (<code><a href="../reference/zoltar_units.html">zoltar_units()</a></code>, <code><a href="../reference/targets.html">targets()</a></code>, and <code><a href="../reference/timezeros.html">timezeros()</a></code> - concepts that are explained at <a href="https://docs.zoltardata.com/">docs.zoltardata.com</a> ), <code><a href="../reference/scores.html">scores()</a></code> and <code><a href="../reference/truth.html">truth()</a></code>. As an example, let’s get its score data. (Note that available scores are limited due to the nature of the example project.)</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">score_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/scores.html">scores</a></span>(<span class="no">zoltar_connection</span>, <span class="no">project_url</span>)
<span class="no">score_data</span>
<span class="co">#&gt; # A tibble: 0 x 22</span>
<span class="co">#&gt; # … with 22 variables: model &lt;chr&gt;, timezero &lt;chr&gt;, season &lt;chr&gt;, unit &lt;chr&gt;,</span>
<span class="co">#&gt; #   target &lt;chr&gt;, truth &lt;chr&gt;, error &lt;chr&gt;, abs_error &lt;chr&gt;,</span>
<span class="co">#&gt; #   log_single_bin &lt;chr&gt;, log_multi_bin &lt;chr&gt;, pit &lt;chr&gt;, interval_2 &lt;chr&gt;,</span>
<span class="co">#&gt; #   interval_5 &lt;chr&gt;, interval_10 &lt;chr&gt;, interval_20 &lt;chr&gt;, interval_30 &lt;chr&gt;,</span>
<span class="co">#&gt; #   interval_40 &lt;chr&gt;, interval_50 &lt;chr&gt;, interval_60 &lt;chr&gt;, interval_70 &lt;chr&gt;,</span>
<span class="co">#&gt; #   interval_80 &lt;chr&gt;, interval_90 &lt;chr&gt;</span></pre></body></html></div>
</div>
<div id="query-a-projects-forecast-data" class="section level2">
<h2 class="hasAnchor">
<a href="#query-a-projects-forecast-data" class="anchor"></a>Query a project’s forecast data</h2>
<p>You can query a project’s forecast data using the <code><a href="../reference/submit_query.html">submit_query()</a></code> function. Keep in mind that Zoltar enqueues long operations like querying and uploading forecasts, which keeps the site responsive but makes the Zoltar API a little more complicated. Rather than having the <code><a href="../reference/submit_query.html">submit_query()</a></code> function <em>block</em> until the query is done, you instead get a quick response in the form of a <code>Job</code> URL that you can pass to the <code><a href="../reference/job_info.html">job_info()</a></code> function to check its status and find out if the upload is pending, successfully finished, or failed). (This is called <em>polling</em> the host to ask the status.) Here we poll every second using a helper function:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">busy_poll_job</span> <span class="kw">&lt;-</span> <span class="kw">function</span>(<span class="no">zoltar_connection</span>, <span class="no">job_url</span>) {
  <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"polling for status change. job: "</span>, <span class="no">job_url</span>, <span class="st">"\n"</span>))
  <span class="kw">while</span> (<span class="fl">TRUE</span>) {
    <span class="no">the_job_info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/job_info.html">job_info</a></span>(<span class="no">zoltar_connection</span>, <span class="no">job_url</span>)
    <span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="no">the_job_info</span>$<span class="no">status</span>, <span class="st">"\n"</span>))
    <span class="kw">if</span> (<span class="no">the_job_info</span>$<span class="no">status</span> <span class="kw">==</span> <span class="st">"FAILED"</span>) {
      <span class="fu"><a href="https://rdrr.io/r/base/stop.html">stop</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"job failed: job_url="</span>, <span class="no">job_url</span>, <span class="st">", failure_message="</span>, <span class="no">the_job_info</span>$<span class="no">failure_message</span>), <span class="kw">call.</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
    }
    <span class="kw">if</span> (<span class="no">the_job_info</span>$<span class="no">status</span> <span class="kw">==</span> <span class="st">"SUCCESS"</span>) {
      <span class="kw">break</span>
    }
    <span class="fu"><a href="https://rdrr.io/r/base/Sys.sleep.html">Sys.sleep</a></span>(<span class="fl">1</span>)
  }
}</pre></body></html></div>
<p>We use the <code><a href="../reference/job_data.html">job_data()</a></code> function when the query is successfully completed to get the results as a <code>data.frame</code>. Putting it together:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">job_url</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/submit_query.html">submit_query</a></span>(<span class="no">zoltar_connection</span>, <span class="no">project_url</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>())
<span class="fu">busy_poll_job</span>(<span class="no">zoltar_connection</span>, <span class="no">job_url</span>)
<span class="co">#&gt; polling for status change. job: http://127.0.0.1:8000/api/job/102/</span>
<span class="co">#&gt; QUEUED</span>
<span class="co">#&gt; SUCCESS</span>
<span class="no">the_job_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/job_data.html">job_data</a></span>(<span class="no">zoltar_connection</span>, <span class="no">job_url</span>)
<span class="no">the_job_data</span>
<span class="co">#&gt; # A tibble: 62 x 15</span>
<span class="co">#&gt;    model timezero   season unit  target class value cat    prob sample quantile</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;date&gt;     &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;</span>
<span class="co">#&gt;  1 docs… 2011-10-02 2011-… loca… pct n… bin   &lt;NA&gt;  1.1    0.3  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  2 docs… 2011-10-02 2011-… loca… pct n… bin   &lt;NA&gt;  2.2    0.2  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  3 docs… 2011-10-02 2011-… loca… pct n… bin   &lt;NA&gt;  3.3    0.5  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  4 docs… 2011-10-02 2011-… loca… cases… bin   &lt;NA&gt;  2      0.1  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  5 docs… 2011-10-02 2011-… loca… cases… bin   &lt;NA&gt;  50     0.9  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  6 docs… 2011-10-02 2011-… loca… seaso… bin   &lt;NA&gt;  mode…  0.1  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  7 docs… 2011-10-02 2011-… loca… seaso… bin   &lt;NA&gt;  seve…  0.9  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  8 docs… 2011-10-02 2011-… loca… above… bin   &lt;NA&gt;  True   0.9  &lt;NA&gt;         NA</span>
<span class="co">#&gt;  9 docs… 2011-10-02 2011-… loca… above… bin   &lt;NA&gt;  False  0.1  &lt;NA&gt;         NA</span>
<span class="co">#&gt; 10 docs… 2011-10-02 2011-… loca… Seaso… bin   &lt;NA&gt;  2019…  0.01 &lt;NA&gt;         NA</span>
<span class="co">#&gt; # … with 52 more rows, and 4 more variables: family &lt;chr&gt;, param1 &lt;dbl&gt;,</span>
<span class="co">#&gt; #   param2 &lt;dbl&gt;, param3 &lt;lgl&gt;</span></pre></body></html></div>
<p>Hopefully you’ll “SUCCESS” eventually printed and then the resulting data itself.</p>
</div>
<div id="get-a-model-to-work-with-and-list-its-info-and-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#get-a-model-to-work-with-and-list-its-info-and-forecasts" class="anchor"></a>Get a model to work with and list its info and forecasts</h2>
<p>Now let’s work with a particular model, getting its URL by name and then passing it to the <code><a href="../reference/model_info.html">model_info()</a></code> function to get details. Then use the <code><a href="../reference/forecasts.html">forecasts()</a></code> function to get a <code>data.frame</code> of that model’s forecasts (there is only one). Note that obtaining the model’s URL is straightforward because it is provided in the <code>url</code> column of <code>the_models</code>.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">model_url</span> <span class="kw">&lt;-</span> <span class="no">the_models</span>[<span class="no">the_models</span>$<span class="no">name</span> <span class="kw">==</span> <span class="st">"docs forecast model"</span>, <span class="st">"url"</span>]
<span class="no">the_model_info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/model_info.html">model_info</a></span>(<span class="no">zoltar_connection</span>, <span class="no">model_url</span>)
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">the_model_info</span>)
<span class="co">#&gt; [1] "id"           "url"          "project"      "owner"        "name"        </span>
<span class="co">#&gt; [6] "abbreviation" "description"  "home_url"     "aux_data_url"</span>
<span class="no">the_model_info</span>$<span class="no">name</span>
<span class="co">#&gt; [1] "docs forecast model"</span>

<span class="no">the_forecasts</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/forecasts.html">forecasts</a></span>(<span class="no">zoltar_connection</span>, <span class="no">model_url</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">the_forecasts</span>)
<span class="co">#&gt; 'data.frame':    1 obs. of  8 variables:</span>
<span class="co">#&gt;  $ id                : int 171</span>
<span class="co">#&gt;  $ url               : chr "http://127.0.0.1:8000/api/forecast/171/"</span>
<span class="co">#&gt;  $ forecast_model_url: chr "http://127.0.0.1:8000/api/model/44/"</span>
<span class="co">#&gt;  $ source            : chr "docs-predictions.json"</span>
<span class="co">#&gt;  $ timezero_url      : chr "http://127.0.0.1:8000/api/timezero/92/"</span>
<span class="co">#&gt;  $ created_at        : Date, format: "2020-05-21"</span>
<span class="co">#&gt;  $ notes             : chr "a small prediction file"</span>
<span class="co">#&gt;  $ forecast_data_url : chr "http://127.0.0.1:8000/api/forecast/171/data/"</span></pre></body></html></div>
</div>
<div id="finally-download-the-forecasts-data-in-three-formats" class="section level2">
<h2 class="hasAnchor">
<a href="#finally-download-the-forecasts-data-in-three-formats" class="anchor"></a>Finally, download the forecast’s data in three formats</h2>
<p>You can get forecast data using the <code><a href="../reference/download_forecast.html">download_forecast()</a></code> function, which returns a nested <code>list</code> format that corresponds to Zoltar’s native JSON one. That format can be converted to a CSV-friendly <code>data.frame</code> via <code><a href="../reference/data_frame_from_forecast_data.html">data_frame_from_forecast_data()</a></code>, which can represent all prediction types, or <code><a href="../reference/quantile_data_frame_from_forecast_data.html">quantile_data_frame_from_forecast_data()</a></code> for users who are mainly interested in <code>point</code> and <code>quantile</code> data. Please see <a href="https://docs.zoltardata.com/">docs.zoltardata.com</a> for forecast format details.</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">forecast_url</span> <span class="kw">&lt;-</span> <span class="no">the_forecasts</span>[<span class="fl">1</span>, <span class="st">"url"</span>]
<span class="no">forecast_info</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/forecast_info.html">forecast_info</a></span>(<span class="no">zoltar_connection</span>, <span class="no">forecast_url</span>)
<span class="no">forecast_data</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/download_forecast.html">download_forecast</a></span>(<span class="no">zoltar_connection</span>, <span class="no">forecast_url</span>)
<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">forecast_data</span>$<span class="no">predictions</span>)
<span class="co">#&gt; [1] 29</span></pre></body></html></div>
<p>As a <code>data.frame</code>:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">forecast_data_frame</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/data_frame_from_forecast_data.html">data_frame_from_forecast_data</a></span>(<span class="no">forecast_data</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">forecast_data_frame</span>)
<span class="co">#&gt; Classes 'data.table' and 'data.frame':   62 obs. of  12 variables:</span>
<span class="co">#&gt;  $ unit    : chr  "location1" "location1" "location1" "location1" ...</span>
<span class="co">#&gt;  $ target  : chr  "Season peak week" "Season peak week" "Season peak week" "Season peak week" ...</span>
<span class="co">#&gt;  $ class   : chr  "point" "bin" "bin" "bin" ...</span>
<span class="co">#&gt;  $ value   : chr  "2019-12-22" NA NA NA ...</span>
<span class="co">#&gt;  $ cat     : chr  NA "2019-12-15" "2019-12-22" "2019-12-29" ...</span>
<span class="co">#&gt;  $ prob    : chr  NA "0.01" "0.1" "0.89" ...</span>
<span class="co">#&gt;  $ sample  : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ quantile: chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ family  : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ param1  : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ param2  : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ param3  : chr  NA NA NA NA ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></pre></body></html></div>
<p>And just quantile data:</p>
<div class="sourceCode"><html><body><pre class="r"><span class="no">forecast_data_frame</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/quantile_data_frame_from_forecast_data.html">quantile_data_frame_from_forecast_data</a></span>(<span class="no">forecast_data</span>)
<span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span>(<span class="no">forecast_data_frame</span>)
<span class="co">#&gt; 'data.frame':    21 obs. of  5 variables:</span>
<span class="co">#&gt;  $ location: chr  "location1" "location1" "location1" "location1" ...</span>
<span class="co">#&gt;  $ target  : chr  "Season peak week" "above baseline" "pct next week" "season severity" ...</span>
<span class="co">#&gt;  $ type    : chr  "point" "point" "point" "point" ...</span>
<span class="co">#&gt;  $ quantile: chr  NA NA NA NA ...</span>
<span class="co">#&gt;  $ value   : chr  "2019-12-22" "TRUE" "2.1" "mild" ...</span>
<span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></pre></body></html></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Matthew Cornell, Nicholas Reich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
